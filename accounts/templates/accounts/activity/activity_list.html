{% extends 'base.html' %}
{% load views humanize static %}

{% block title %}
Оповещения
{% endblock title %}

{% block breadcrumbs %}
{% breadcrumb "Главная" 'contests:index' %}
{% breadcrumb "Оповещения" %}
{% endblock breadcrumbs %}

{% block content %}
<legend>Оповещения</legend>

<div id="activities" class="activity-list list-group mb-3">
    {% if activities %}
    {% for activity in activities %}
    <li class="activity-list-item list-group-item d-flex {% if not activity.is_read %}bg-light{% endif %}">
    <span class="mr-auto ">
        {% if activity.subject.username %}
        <a href="{{ activity.subject.account.get_absolute_url }}">{{ activity.subject.account }}</a>
        {% else %}
        <a href="{{ activity.subject.get_absolute_url }}"> {{ activity.subject }}</a>
        {% endif %}
        {{ activity.action }}
        {% if activity.object %}
        <a href="{{ activity.object.get_absolute_url }}"> {{ activity.object }}</a>
        {% endif %}
        {% if activity.reference %}
        / <a href="{{ activity.reference.get_absolute_url }}"> {{ activity.reference }}</a>
        {% endif %}
    </span>
    <span class="text-muted text-right"  style="width: 20%;">
        {{ activity.date_created|naturaltime }}
    </span>
    </li>
    {% endfor %}
    {% else %}
    <div class="alert alert-info mb-3" role="alert">
        Оповещений нет
    </div>
    {% endif %}
</div>
{% if page_obj.has_next %}
<a class="activity-list-more btn btn-block btn-link" href="?page={{ page_obj.next_page_number }}">еще</a>
{% endif %}

{% endblock content %}

{% block submenu %}
<div class="list-group mb-3">
    <a href="{% url 'accounts:activity-settings' %}" class="list-group-item list-group-item-action"><i class="fa fa-cog fa-fw"></i> Настройки оповещений</a>
</div>
{% endblock submenu %}

{% block javascript %}
<script src="{% static 'MathJax/es5/tex-chtml.js' %}" type="text/javascript"></script>
<script src="{% static 'waypoints/lib/jquery.waypoints.min.js' %}" type="text/javascript"></script>
<script src="{% static 'waypoints/lib/shortcuts/infinite.min.js' %}" type="text/javascript"></script>
<script>
    var infinite = new Waypoint.Infinite({
        element: $('.activity-list')[0],
        items: '.activity-list-item',
        more: '.activity-list-more'
    });
</script>
{% endblock javascript %}